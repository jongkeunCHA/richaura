<!DOCTYPE html>
<!-- saved from url=(0048)file:///Users/hanwha/Downloads/booty-test_4.html -->
<html lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’ ë¶€í‹° í…ŒìŠ¤íŠ¸ | ë‚´ ê´€ìƒ ì† ìˆ¨ê²¨ì§„ ìì‚°ê°€ DNA ë¶„ì„</title>
<link rel="preconnect" href="https://fonts.googleapis.com/">
<link href="./ğŸ’ á„‡á…®á„á…µ á„á…¦á„‰á…³á„á…³ _ á„‚á…¢ á„€á…ªá†«á„‰á…¡á†¼ á„‰á…©á†¨ á„‰á…®á†·á„€á…§á„Œá…µá†« á„Œá…¡á„‰á…¡á†«á„€á…¡ DNA á„‡á…®á†«á„‰á…¥á†¨_files/css2" rel="stylesheet">
<script src="./ğŸ’ á„‡á…®á„á…µ á„á…¦á„‰á…³á„á…³ _ á„‚á…¢ á„€á…ªá†«á„‰á…¡á†¼ á„‰á…©á†¨ á„‰á…®á†·á„€á…§á„Œá…µá†« á„Œá…¡á„‰á…¡á†«á„€á…¡ DNA á„‡á…®á†«á„‰á…¥á†¨_files/tf.min.js"></script>
<script src="./ğŸ’ á„‡á…®á„á…µ á„á…¦á„‰á…³á„á…³ _ á„‚á…¢ á„€á…ªá†«á„‰á…¡á†¼ á„‰á…©á†¨ á„‰á…®á†·á„€á…§á„Œá…µá†« á„Œá…¡á„‰á…¡á†«á„€á…¡ DNA á„‡á…®á†«á„‰á…¥á†¨_files/teachablemachine-image.min.js"></script>
<script src="./ğŸ’ á„‡á…®á„á…µ á„á…¦á„‰á…³á„á…³ _ á„‚á…¢ á„€á…ªá†«á„‰á…¡á†¼ á„‰á…©á†¨ á„‰á…®á†·á„€á…§á„Œá…µá†« á„Œá…¡á„‰á…¡á†«á„€á…¡ DNA á„‡á…®á†«á„‰á…¥á†¨_files/html2canvas.min.js"></script>
<style>
/* ===== RESET & BASE ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --aurora1: #ffd6e7;
  --aurora2: #c8e6ff;
  --aurora3: #d4f1d4;
  --aurora4: #fff3cd;
  --aurora5: #e8d5ff;
  --glass-bg: rgba(255,255,255,0.45);
  --glass-border: rgba(255,255,255,0.75);
  --glass-shadow: rgba(200,180,255,0.25);
  --text-dark: #2d1f4e;
  --text-mid: #5a4a7a;
  --text-soft: #8a7aaa;
  --gold: #f5c842;
  --gold2: #ffaa00;
  --pink: #ff6eb4;
  --mint: #00d4aa;
  --purple: #9b59ff;
}

html { scroll-behavior: smooth; }

body {
  font-family: 'Gowun Dodum', sans-serif;
  min-height: 100vh;
  overflow-x: hidden;
  background: #f0e8ff;
  color: var(--text-dark);
  cursor: default;
}

/* ===== AURORA BACKGROUND ===== */
.aurora-bg {
  position: fixed;
  inset: 0;
  z-index: 0;
  overflow: hidden;
}

.aurora-bg::before,
.aurora-bg::after,
.aurora-orb-1,
.aurora-orb-2,
.aurora-orb-3 {
  position: absolute;
  border-radius: 50%;
  filter: blur(80px);
  animation: floatOrb linear infinite;
}

.aurora-bg::before {
  content: '';
  width: 700px; height: 700px;
  background: radial-gradient(circle, var(--aurora1) 0%, transparent 70%);
  top: -200px; left: -100px;
  opacity: 0.7;
  animation-duration: 18s;
}
.aurora-bg::after {
  content: '';
  width: 600px; height: 600px;
  background: radial-gradient(circle, var(--aurora2) 0%, transparent 70%);
  bottom: -150px; right: -100px;
  opacity: 0.6;
  animation-duration: 22s;
  animation-direction: reverse;
}
.aurora-orb-1 {
  width: 500px; height: 500px;
  background: radial-gradient(circle, var(--aurora5) 0%, transparent 70%);
  top: 30%; left: 40%;
  opacity: 0.5;
  animation-duration: 15s;
}
.aurora-orb-2 {
  width: 400px; height: 400px;
  background: radial-gradient(circle, var(--aurora3) 0%, transparent 70%);
  top: 60%; left: 10%;
  opacity: 0.5;
  animation-duration: 19s;
  animation-direction: reverse;
}
.aurora-orb-3 {
  width: 350px; height: 350px;
  background: radial-gradient(circle, var(--aurora4) 0%, transparent 70%);
  top: 10%; right: 20%;
  opacity: 0.45;
  animation-duration: 25s;
}

@keyframes floatOrb {
  0% { transform: translate(0,0) scale(1); }
  25% { transform: translate(40px,-30px) scale(1.05); }
  50% { transform: translate(-20px,50px) scale(0.95); }
  75% { transform: translate(-50px,-20px) scale(1.03); }
  100% { transform: translate(0,0) scale(1); }
}

/* ===== LAYOUT ===== */
.page-wrap {
  position: relative;
  z-index: 1;
  max-width: 540px;
  margin: 0 auto;
  padding: 2rem 1.2rem 4rem;
}

/* ===== GLASS CARD ===== */
.glass-card {
  background: var(--glass-bg);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 1.5px solid var(--glass-border);
  border-radius: 28px;
  box-shadow:
    0 8px 32px var(--glass-shadow),
    inset 0 1px 0 rgba(255,255,255,0.9),
    inset 0 -1px 0 rgba(255,255,255,0.3);
  padding: 2rem;
  transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1), box-shadow 0.3s ease;
}

.glass-card:hover {
  transform: translateY(-3px);
  box-shadow:
    0 16px 48px var(--glass-shadow),
    inset 0 1px 0 rgba(255,255,255,0.9),
    inset 0 -1px 0 rgba(255,255,255,0.3);
}

/* ===== HEADER ===== */
.header-card {
  text-align: center;
  margin-bottom: 1.2rem;
  padding: 1.2rem 1.5rem 1rem;
}

.badge-top {
  display: inline-block;
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  color: white;
  font-size: 0.68rem;
  font-weight: 700;
  letter-spacing: 0.15em;
  padding: 0.3rem 0.9rem;
  border-radius: 100px;
  margin-bottom: 0.7rem;
  box-shadow: 0 4px 15px rgba(245,200,66,0.4);
  animation: pulse 2.5s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { box-shadow: 0 4px 15px rgba(245,200,66,0.4); }
  50% { box-shadow: 0 4px 30px rgba(245,200,66,0.7), 0 0 0 6px rgba(245,200,66,0.1); }
}

.main-title {
  font-family: 'Hahmlet', serif;
  font-size: clamp(1.7rem, 6vw, 2.3rem);
  font-weight: 900;
  background: linear-gradient(135deg, #7b2fff 0%, #ff6eb4 50%, #ffaa00 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  line-height: 1.2;
  letter-spacing: -0.02em;
  margin-bottom: 0.3rem;
}

.sub-title {
  font-size: 0.82rem;
  color: var(--text-mid);
  line-height: 1.6;
}

.emoji-float {
  display: inline-block;
  font-size: 1.3rem;
  animation: emojiFloat 3s ease-in-out infinite;
  margin: 0.3rem 0.2rem 0;
}
.emoji-float:nth-child(2) { animation-delay: 0.5s; }
.emoji-float:nth-child(3) { animation-delay: 1s; }

@keyframes emojiFloat {
  0%, 100% { transform: translateY(0) rotate(0deg); }
  50% { transform: translateY(-8px) rotate(5deg); }
}

/* ===== UPLOAD ZONE ===== */
.upload-card { margin-bottom: 1.2rem; padding: 0 !important; overflow: hidden; }

/* ì •ì‚¬ê°í˜• ê³ ì • í”„ë ˆì„ â€” ì—…ë¡œë“œ/í”„ë¦¬ë·° ê³µí†µ ë˜í¼ */
.square-frame {
  width: 100%;
  aspect-ratio: 1 / 1;
  position: relative;
  border-radius: 20px;
  overflow: hidden;
}

.upload-zone {
  border: 2.5px dashed rgba(155,89,255,0.35);
  border-radius: 20px;
  width: 100%; height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  cursor: pointer;
  background: rgba(255,255,255,0.3);
  transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1);
  position: relative;
  overflow: hidden;
}

.upload-zone::before {
  content: 'âœ¨';
  position: absolute;
  font-size: 6rem;
  opacity: 0.04;
  top: 50%; left: 50%;
  transform: translate(-50%,-50%);
  pointer-events: none;
}

.upload-zone:hover, .upload-zone.drag-over {
  border-color: var(--purple);
  background: rgba(155,89,255,0.08);
  transform: scale(1.01);
  box-shadow: 0 0 0 4px rgba(155,89,255,0.1);
}

.upload-zone:active { transform: scale(0.98); }

.upload-icon-wrap {
  width: 70px; height: 70px;
  background: linear-gradient(135deg, rgba(155,89,255,0.15), rgba(255,110,180,0.15));
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  margin: 0 auto 1rem;
  font-size: 1.8rem;
  border: 1.5px solid rgba(255,255,255,0.8);
  box-shadow: 0 4px 15px rgba(155,89,255,0.2),
              inset 0 1px 0 rgba(255,255,255,0.9);
  transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1);
}

.upload-zone:hover .upload-icon-wrap {
  transform: scale(1.1) rotate(-5deg);
}

.upload-title {
  font-family: 'Hahmlet', serif;
  font-size: 1.15rem;
  font-weight: 700;
  color: var(--text-dark);
  margin-bottom: 0.4rem;
}

.upload-hint {
  font-size: 0.78rem;
  color: var(--text-soft);
}

#fileInput { display: none; }

/* ===== PREVIEW ===== */
#preview-section { display: none; }

/* ì‚¬ì§„ì´ ì •ì‚¬ê°í˜• í”„ë ˆì„ì„ ê½‰ ì±„ìš°ëŠ” ë˜í¼ */
.preview-photo-wrap {
  width: 100%; height: 100%;
  position: relative;
  cursor: pointer;
}

#preview-img {
  width: 100%; height: 100%;
  object-fit: cover;
  display: block;
  transition: transform 0.3s ease, filter 0.3s ease;
}

.preview-photo-wrap:hover #preview-img {
  transform: scale(1.03);
  filter: brightness(0.75);
}

/* í˜¸ë²„ ì‹œ ë‚˜íƒ€ë‚˜ëŠ” "ë°”ê¾¸ê¸°" ì˜¤ë²„ë ˆì´ */
.preview-overlay {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  opacity: 0;
  transition: opacity 0.3s ease;
  background: rgba(123,47,255,0.25);
  backdrop-filter: blur(2px);
}
.preview-photo-wrap:hover .preview-overlay { opacity: 1; }
.preview-overlay span {
  background: rgba(255,255,255,0.9);
  color: var(--purple);
  font-family: 'Hahmlet', serif;
  font-size: 0.9rem;
  font-weight: 700;
  padding: 0.6rem 1.4rem;
  border-radius: 100px;
  box-shadow: 0 4px 16px rgba(123,47,255,0.25);
}

.preview-bottom {
  padding: 1rem 1rem 0.2rem;
  text-align: center;
}
.preview-ready {
  font-family: 'Hahmlet', serif;
  font-size: 1rem;
  font-weight: 700;
  color: var(--text-dark);
  margin-bottom: 0.25rem;
}
.preview-sub { font-size: 0.8rem; color: var(--text-soft); }



/* ===== ANALYZE BUTTON ===== */
#analyze-btn {
  display: none;
  width: 100%;
  padding: 1.1rem;
  background: linear-gradient(135deg, #7b2fff 0%, #ff6eb4 60%, #ffaa00 100%);
  background-size: 200% 200%;
  border: none;
  border-radius: 18px;
  color: white;
  font-family: 'Hahmlet', serif;
  font-size: 1.15rem;
  font-weight: 700;
  letter-spacing: 0.05em;
  cursor: pointer;
  box-shadow: 0 8px 30px rgba(123,47,255,0.4),
              inset 0 1px 0 rgba(255,255,255,0.3);
  transition: all 0.3s cubic-bezier(0.34,1.56,0.64,1);
  animation: gradShift 4s ease infinite;
  margin-bottom: 1.2rem;
}

@keyframes gradShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

#analyze-btn:hover {
  transform: translateY(-3px) scale(1.02);
  box-shadow: 0 12px 40px rgba(123,47,255,0.5),
              inset 0 1px 0 rgba(255,255,255,0.3);
}

#analyze-btn:active {
  transform: scale(0.96);
  box-shadow: 0 4px 15px rgba(123,47,255,0.3);
}

#analyze-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

/* ===== LOADING ===== */
#loading-section {
  display: none;
  text-align: center;
  padding: 3rem 2rem;
}

.loader-ring {
  width: 72px; height: 72px;
  margin: 0 auto 1.5rem;
  position: relative;
}

.loader-ring::before, .loader-ring::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 50%;
  border: 4px solid transparent;
  animation: spin 1.2s linear infinite;
}

.loader-ring::before {
  border-top-color: var(--purple);
  border-right-color: var(--pink);
}

.loader-ring::after {
  border-bottom-color: var(--gold);
  border-left-color: var(--mint);
  animation-direction: reverse;
  animation-duration: 0.8s;
  inset: 8px;
}

@keyframes spin { to { transform: rotate(360deg); } }

.loader-emoji {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%,-50%);
  font-size: 1.5rem;
}

.load-text {
  font-family: 'Hahmlet', serif;
  font-size: 1.1rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--purple), var(--pink));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 0.5rem;
}

.load-sub {
  font-size: 0.8rem;
  color: var(--text-soft);
  animation: blink 1.5s ease-in-out infinite;
}

@keyframes blink { 0%,100% { opacity:1; } 50% { opacity:0.3; } }

/* ===== RESULTS ===== */
/* Result Card (for screenshot) */
#result-card {
  background: linear-gradient(135deg, rgba(255,255,255,0.7) 0%, rgba(255,230,255,0.6) 50%, rgba(230,240,255,0.7) 100%);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 2px solid rgba(255,255,255,0.85);
  border-radius: 28px;
  padding: 2rem;
  margin-bottom: 1.2rem;
  box-shadow:
    0 12px 40px rgba(155,89,255,0.2),
    inset 0 1px 0 rgba(255,255,255,0.95);
  animation: resultPop 0.6s cubic-bezier(0.34,1.56,0.64,1) forwards;
  transform-origin: center;
}

@keyframes resultPop {
  0% { opacity:0; transform: scale(0.85) translateY(20px); }
  100% { opacity:1; transform: scale(1) translateY(0); }
}

.result-type-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  background: linear-gradient(135deg, var(--purple), var(--pink));
  color: white;
  font-size: 0.75rem;
  font-weight: 700;
  letter-spacing: 0.1em;
  padding: 0.4rem 1rem;
  border-radius: 100px;
  margin-bottom: 1rem;
  box-shadow: 0 4px 15px rgba(123,47,255,0.35);
}

.result-type-name {
  font-family: 'Hahmlet', serif;
  font-size: clamp(2rem, 8vw, 2.8rem);
  font-weight: 900;
  background: linear-gradient(135deg, #5a0aff 0%, #ff3d9a 50%, #ff8c00 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  line-height: 1.15;
  margin-bottom: 0.8rem;
}

.result-desc {
  font-size: 0.92rem;
  color: var(--text-mid);
  line-height: 1.75;
  margin-bottom: 1.5rem;
  padding: 1rem;
  background: rgba(255,255,255,0.5);
  border-radius: 14px;
  border-left: 3px solid var(--pink);
}

/* Fun Stats Grid */
.stats-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.75rem;
  margin-bottom: 1.5rem;
}

.stat-item {
  background: rgba(255,255,255,0.6);
  border: 1.5px solid rgba(255,255,255,0.85);
  border-radius: 16px;
  padding: 0.9rem 0.8rem;
  text-align: center;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.9), 0 4px 12px rgba(155,89,255,0.08);
  transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1);
}

.stat-item:hover { transform: scale(1.03) translateY(-2px); }

.stat-icon { font-size: 1.4rem; margin-bottom: 0.3rem; }
.stat-label { font-size: 0.67rem; color: var(--text-soft); letter-spacing: 0.05em; margin-bottom: 0.2rem; }
.stat-value {
  font-family: 'Hahmlet', serif;
  font-size: 0.82rem;
  font-weight: 700;
  color: var(--text-dark);
  line-height: 1.3;
}

/* Probability Bars */
.bars-wrap {
  margin-bottom: 0;
}

.bars-title {
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--text-soft);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin-bottom: 0.9rem;
}

.bar-row {
  display: flex;
  align-items: center;
  gap: 0.7rem;
  margin-bottom: 0.65rem;
}

.bar-label {
  width: 54px;
  font-size: 0.8rem;
  color: var(--text-mid);
  text-align: right;
  flex-shrink: 0;
}

.bar-track {
  flex: 1;
  height: 8px;
  background: rgba(155,89,255,0.1);
  border-radius: 100px;
  overflow: hidden;
}

.bar-fill {
  height: 100%;
  border-radius: 100px;
  width: 0%;
  transition: width 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.bar-pct {
  width: 38px;
  font-size: 0.78rem;
  font-weight: 700;
  text-align: right;
  flex-shrink: 0;
}

.bar-fill-0 { background: linear-gradient(90deg, #b44fff, #7b2fff); }
.bar-fill-1 { background: linear-gradient(90deg, #ff8cc4, #ff3d9a); }
.bar-fill-2 { background: linear-gradient(90deg, #ffe066, #ffaa00); }
.bar-fill-3 { background: linear-gradient(90deg, #72f5c8, #00b894); }
.bar-fill-4 { background: linear-gradient(90deg, #74c0fc, #339af0); }
.bar-pct-0 { color: #7b2fff; }
.bar-pct-1 { color: #ff3d9a; }
.bar-pct-2 { color: #e08c00; }
.bar-pct-3 { color: #00b894; }
.bar-pct-4 { color: #339af0; }

/* ===== MONETIZATION CARD ===== */
.ad-card {
  margin-bottom: 1.2rem;
}

.ad-inner {
  background: linear-gradient(135deg, rgba(255,240,255,0.7), rgba(240,248,255,0.7));
}

.ad-title {
  font-family: 'Hahmlet', serif;
  font-size: 1rem;
  font-weight: 700;
  color: var(--text-dark);
  margin-bottom: 0.3rem;
}

.ad-sub {
  font-size: 0.78rem;
  color: var(--text-soft);
  margin-bottom: 1rem;
}

.ad-items {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.7rem;
}

.ad-item {
  background: rgba(255,255,255,0.7);
  border: 1.5px solid rgba(255,255,255,0.9);
  border-radius: 14px;
  padding: 0.85rem 0.5rem;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.34,1.56,0.64,1);
  box-shadow: 0 4px 12px rgba(155,89,255,0.08),
              inset 0 1px 0 rgba(255,255,255,0.9);
  text-decoration: none;
  display: block;
}

.ad-item:hover {
  transform: translateY(-4px) scale(1.04);
  box-shadow: 0 10px 24px rgba(155,89,255,0.18),
              inset 0 1px 0 rgba(255,255,255,0.9);
}

.ad-item-icon { font-size: 1.6rem; margin-bottom: 0.35rem; }
.ad-item-name {
  font-size: 0.7rem;
  font-weight: 700;
  color: var(--text-dark);
  margin-bottom: 0.2rem;
}
.ad-item-price {
  font-size: 0.65rem;
  color: var(--pink);
  font-weight: 700;
}

/* ===== ACTION BUTTONS ===== */
.action-btns {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.8rem;
  margin-bottom: 1.2rem;
}

.btn-save {
  padding: 1rem;
  background: linear-gradient(135deg, #7b2fff, #ff6eb4);
  border: none;
  border-radius: 16px;
  color: white;
  font-family: 'Hahmlet', serif;
  font-size: 0.92rem;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 6px 20px rgba(123,47,255,0.35),
              inset 0 1px 0 rgba(255,255,255,0.3);
  transition: all 0.3s cubic-bezier(0.34,1.56,0.64,1);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.4rem;
}

.btn-save:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(123,47,255,0.45); }
.btn-save:active { transform: scale(0.95); }

.btn-retry {
  padding: 1rem;
  background: rgba(255,255,255,0.6);
  backdrop-filter: blur(10px);
  border: 1.5px solid rgba(255,255,255,0.85);
  border-radius: 16px;
  color: var(--text-mid);
  font-family: 'Hahmlet', serif;
  font-size: 0.92rem;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 6px 20px rgba(155,89,255,0.1),
              inset 0 1px 0 rgba(255,255,255,0.9);
  transition: all 0.3s cubic-bezier(0.34,1.56,0.64,1);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.4rem;
}

.btn-retry:hover { transform: translateY(-3px); background: rgba(255,255,255,0.8); }
.btn-retry:active { transform: scale(0.95); }

/* ===== FOOTER ===== */
.footer-card {
  text-align: center;
  padding: 1.2rem;
}
.footer-card p {
  font-size: 0.72rem;
  color: var(--text-soft);
  line-height: 1.7;
}

/* ===== TOAST ===== */
.toast {
  position: fixed;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%) translateY(100px);
  background: rgba(255,255,255,0.9);
  backdrop-filter: blur(20px);
  border: 1.5px solid rgba(255,255,255,0.9);
  border-radius: 100px;
  padding: 0.8rem 1.5rem;
  font-size: 0.85rem;
  font-weight: 700;
  color: var(--text-dark);
  box-shadow: 0 8px 30px rgba(155,89,255,0.25);
  z-index: 9999;
  transition: transform 0.4s cubic-bezier(0.34,1.56,0.64,1);
}
.toast.show { transform: translateX(-50%) translateY(0); }

/* ===== RESULT OVERLAY ===== */
#result-overlay {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 500;
  background: var(--glass-bg);
  backdrop-filter: blur(30px) saturate(200%);
  -webkit-backdrop-filter: blur(30px) saturate(200%);
  animation: overlayIn 0.45s cubic-bezier(0.16,1,0.3,1) forwards;
}

@keyframes overlayIn {
  from { opacity:0; transform: translateY(40px); }
  to   { opacity:1; transform: translateY(0); }
}

#result-overlay-inner {
  max-width: 540px;
  margin: 0 auto;
  height: 100%;
  display: flex;
  flex-direction: column;
}

.overlay-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 1.2rem;
  border-bottom: 1px solid rgba(255,255,255,0.4);
  background: rgba(255,255,255,0.3);
  backdrop-filter: blur(10px);
  flex-shrink: 0;
}

.overlay-title {
  font-family: 'Hahmlet', serif;
  font-size: 0.85rem;
  font-weight: 700;
  color: var(--purple);
  letter-spacing: 0.1em;
}

.back-btn {
  background: none;
  border: 1.5px solid rgba(155,89,255,0.3);
  border-radius: 100px;
  color: var(--purple);
  font-family: 'Gowun Dodum', sans-serif;
  font-size: 0.78rem;
  padding: 0.35rem 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
}
.back-btn:hover { background: rgba(155,89,255,0.1); }

.overlay-body {
  flex: 1;
  overflow-y: auto;
  padding: 1.2rem 1.2rem 3rem;
  -webkit-overflow-scrolling: touch;
}

.overlay-footer {
  text-align: center;
  font-size: 0.72rem;
  color: var(--text-soft);
  margin-top: 1.5rem;
  line-height: 1.8;
}

/* ===== JELLY ANIMATION ===== */
@keyframes jelly {
  0%,100% { transform: scale(1); }
  20% { transform: scale(1.08,0.92); }
  40% { transform: scale(0.94,1.06); }
  60% { transform: scale(1.04,0.96); }
  80% { transform: scale(0.98,1.02); }
}
.jelly { animation: jelly 0.6s ease forwards; }
</style>
</head>
<body>

<div class="aurora-bg">
  <div class="aurora-orb-1"></div>
  <div class="aurora-orb-2"></div>
  <div class="aurora-orb-3"></div>
</div>

<div class="page-wrap">

  <!-- HEADER -->
  <div class="glass-card header-card">
    <span class="badge-top">âœ¦ AI ê´€ìƒ ë¶„ì„ Â· 2026 EDITION âœ¦</span>
    <h1 class="main-title">ë¶€í‹° í…ŒìŠ¤íŠ¸</h1>
    <p class="sub-title">
      ì…€ì¹´ í•œ ì¥ìœ¼ë¡œ ë‚´ ì•ˆì— ì ë“ <br>
      ìì‚°ê°€ DNAë¥¼ ê¹¨ì›Œë“œë¦½ë‹ˆë‹¤ ğŸ’¸
    </p>
    <div style="margin-top:0.8rem">
      <span class="emoji-float">ğŸ’</span>
      <span class="emoji-float">âœ¨</span>
      <span class="emoji-float">ğŸŒŸ</span>
    </div>
  </div>

  <!-- UPLOAD + PREVIEW (í†µí•©) -->
  <div class="glass-card upload-card">
    <input type="file" id="fileInput" accept="image/*">

    <!-- ì •ì‚¬ê°í˜• ê³ ì • í”„ë ˆì„ -->
    <div class="square-frame">

      <!-- ì—…ë¡œë“œ ì „ ê¸°ë³¸ ìƒíƒœ -->
      <div class="upload-zone" id="uploadZone">
        <div class="upload-icon-wrap">ğŸ“¸</div>
        <p class="upload-title">ì–¼êµ´ ì‚¬ì§„ì„ ì˜¬ë ¤ì£¼ì„¸ìš”</p>
        <p class="upload-hint">í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸ Â· ì •ë©´ ì‚¬ì§„ì´ ê°€ì¥ ì •í™•í•´ìš”<br>JPG Â· PNG Â· WEBP Â· ì•ˆì‹¬! ì„œë²„ì— ì €ì¥ ì•ˆ ë©ë‹ˆë‹¤ ğŸ”’</p>
      </div>

      <!-- ì—…ë¡œë“œ í›„ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸° -->
      <div id="preview-section" style="display:none; width:100%; height:100%;">
        <div class="preview-photo-wrap">
          <img id="preview-img" src="file:///Users/hanwha/Downloads/booty-test_4.html" alt="preview">
          <div class="preview-overlay" id="uploadZoneOverlay">
            <span>ğŸ”„ ì‚¬ì§„ ë°”ê¾¸ê¸°</span>
          </div>
        </div>
      </div>

    </div><!-- /square-frame -->

    <!-- ì‚¬ì§„ ì¤€ë¹„ ì•ˆë‚´ (í”„ë ˆì„ ë°”ê¹¥) -->
    <div class="preview-bottom" id="preview-bottom" style="display:none;">
      <p class="preview-ready">âœ… ì‚¬ì§„ ì¤€ë¹„ ì™„ë£Œ!</p>
      <p class="preview-sub">AIê°€ ê´€ìƒ ë¶„ì„ì„ ì‹œì‘í•  ì¤€ë¹„ê°€ ëì–´ìš” ğŸ‘‡</p>
    </div>
  </div>

  <!-- ANALYZE BUTTON -->
  <button id="analyze-btn">ğŸ’ ë‚´ ë¶€í‹° ë¶„ì„í•˜ê¸°</button>

  <!-- LOADING -->
  <div id="loading-section" class="glass-card">
    <div class="loader-ring">
      <div class="loader-emoji">ğŸ”®</div>
    </div>
    <p class="load-text">ë¶€í‹° DNA ë¶„ì„ ì¤‘...</p>
    <p class="load-sub" id="loadingMsg">ê´€ìƒ ë°ì´í„°ë² ì´ìŠ¤ì™€ ëŒ€ì¡° ì¤‘</p>
  </div>

  <!-- RESULTS (í’€ìŠ¤í¬ë¦° ì˜¤ë²„ë ˆì´) -->
  <div id="result-overlay">
    <div id="result-overlay-inner">

      <!-- ìƒë‹¨ í—¤ë” -->
      <div class="overlay-header">
        <button id="backBtn" class="back-btn">â† ëŒì•„ê°€ê¸°</button>
        <span class="overlay-title">âœ¦ ë¶„ì„ ì™„ë£Œ</span>
        <button class="btn-save" id="saveBtn">ğŸ“¸ ì €ì¥</button>
      </div>

      <!-- ìŠ¤í¬ë¡¤ ì˜ì—­ -->
      <div class="overlay-body">

        <!-- Result Card -->
        <div id="result-card">
          <div><span class="result-type-badge">âœ¦ ë‹¹ì‹ ì˜ ê´€ìƒ íƒ€ì…</span></div>
          <p class="result-type-name" id="result-name">â€”</p>
          <p class="result-desc" id="result-desc">â€”</p>
          <div class="stats-grid" id="stats-grid"></div>
          <div class="bars-wrap">
            <p class="bars-title">ğŸ”¬ ì•„ìš°ë¼ ìŠ¤í™íŠ¸ëŸ¼ ë¶„ì„</p>
            <div id="bars-container"></div>
          </div>
        </div>

        <!-- Ad Card -->
        <div class="glass-card ad-card">
          <div class="ad-inner" style="padding:0">
            <div style="padding:1.2rem 1.5rem 0">
              <p class="ad-title">ğŸ›ï¸ ë¶€í‹° ìƒìŠ¹ ë ˆë²¨ì—… ì•„ì´í…œ</p>
              <p class="ad-sub">ë‹¹ì‹ ì˜ ê´€ìƒì— ë”± ë§ëŠ” ì•„ì´í…œ Pick! (íŒŒíŠ¸ë„ˆìŠ¤ ë§í¬)</p>
            </div>
            <div class="ad-items" style="padding:0 1rem 1.2rem" id="ad-items"></div>
          </div>
        </div>

        <!-- ë‹¤ì‹œí•˜ê¸° ë²„íŠ¼ -->
        <button class="btn-retry" id="retryBtn" style="width:100%">ğŸ”„ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°</button>

        <div class="overlay-footer">
          ì´ ê²°ê³¼ëŠ” ì¬ë¯¸ë¡œ ë³´ëŠ” AI ê´€ìƒ í…ŒìŠ¤íŠ¸ì˜ˆìš” ğŸ˜„<br>
          ë¶€í‹°ëŠ” ë§ˆìŒê°€ì§ì—ì„œ ë‚˜ì˜µë‹ˆë‹¤ ğŸ’œ
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <div class="glass-card footer-card">
    <p>ì´ ê²°ê³¼ëŠ” ì¬ë¯¸ë¡œ ë³´ëŠ” AI ê´€ìƒ í…ŒìŠ¤íŠ¸ì˜ˆìš” ğŸ˜„<br>
    Google Teachable Machine ê¸°ë°˜ Â· ì´ë¯¸ì§€ ì„œë²„ ì €ì¥ ì—†ìŒ ğŸ”’<br>
    <strong style="color:var(--purple)">ë¶€í‹°ëŠ” ë§ˆìŒê°€ì§ì—ì„œ ë‚˜ì˜µë‹ˆë‹¤ ğŸ’œ</strong></p>
  </div>

</div>

<div class="toast" id="toast"></div>

<script>
// =============================================
// ğŸ”‘ TEACHABLE MACHINE MODEL URL (ì—¬ê¸°ë§Œ ë°”ê¾¸ë©´ ë¼ìš”!)
// =============================================
const MODEL_URL = 'https://teachablemachine.withgoogle.com/models/Adsz2vqeL/';

// =============================================
// ğŸ¯ 20ê°€ì§€ ê²°ê³¼ ë§¤ì¹­ ë¡œì§
// =============================================
const RESULTS = [
  { name: 'ë¡œì—´ ë¸”ëŸ¬ë“œ',      desc: 'í¸ì˜ì  ì‚¼ê°ê¹€ë°¥ë„ ìŠ¤í…Œì´í¬ì²˜ëŸ¼ ë³´ì¼ ìƒ! ì „ìƒì— ìµœì†Œ ì„±ì£¼ì˜€ì„ í™•ë¥  200%ë„¤ìš”.' },
  { name: 'ëŒ€ì €íƒì˜ ì£¼ì¸',    desc: 'ì—¬ìœ ë¡œìš´ ë°”ì´ë¸Œì—ì„œ ëŠê»´ì§€ëŠ” ì°ë¶€ìì˜ í–¥ê¸°! ë‹¹ì‹ ì´ ë¨¸ë¬´ëŠ” ê³³ì€ ì–´ë””ë“  ê°¤ëŸ¬ë¦¬ê°€ ë¼ìš”.' },
  { name: 'ì•„íŠ¸ ë””ë ‰í„°',      desc: 'ì•ˆëª©ì´ ê³§ ëˆì´ ë˜ëŠ” ì‹¬ë¯¸ì•ˆ ë§Œë ™ ìì‚°ê°€! ë‹¹ì‹ ì´ ê³ ë¥´ë©´ ê·¸ê²Œ ê³§ ì •ë‹µì´ì íŠ¸ë Œë“œ!' },
  { name: 'í´ë˜ì‹ ì•„ì´ì½˜',    desc: 'ìœ í–‰ì€ ë³€í•´ë„ ë‹¹ì‹ ì˜ ê¸°í’ˆì€ ì˜ì›í•˜ë‹ˆê¹Œ! ì‹œê°„ì´ ê°ˆìˆ˜ë¡ ê°€ì¹˜ê°€ í­ë“±í•  ë¹ˆí‹°ì§€ ì™€ì¸ìƒ.' },
  { name: 'íŠ¸ë Œë“œ ì„¸í„°',      desc: 'ëˆì„ ë¶€ë¥´ëŠ” í™”ì œì„±, í¼ ë¯¸ì³ë²„ë¦° ì£¼ì¸ê³µ ê´€ìƒ! ë‹¹ì‹ ì´ ì“´ ì•ˆê²½ í•˜ë‚˜ë¡œ ì£¼ê°€ ìƒí•œê°€ ì¹  ê¸°ì„¸!' },
  { name: 'ìœ ë‹ˆì½˜ ì°½ì—…ì£¼',    desc: 'ë‡Œê°€ ì„¹ì‹œí•´ì„œ í†µì¥ ì”ê³ ê°€ ê°€ë§Œìˆì§ˆ ëª»í•  ìƒ! ì´ë¯¸ ë‚˜ìŠ¤ë‹¥ ìƒì¥ê¹Œì§€ ëë‚´ì…¨ë„¤ìš”?' },
  { name: 'í™í•œ ì½œë ‰í„°',      desc: 'ì·¨í–¥ìœ¼ë¡œ ì„¸ìƒì„ ì••ë„í•˜ëŠ” í”Œë ‰ìŠ¤ ì™•! ë…ë³´ì  ë§¤ë ¥ì€ ì–¸ì œë‚˜ ê°€ì¥ ë†’ì€ ê³³ì—ì„œ ë¹›ë‚˜ìš”.' },
  { name: 'í”„ë¼ì´ë¹— VIP',     desc: 'ì–´ë””ì„œë‚˜ í”„ë¦¬íŒ¨ìŠ¤ ê°€ëŠ¥í•œ ê·€í•œ ì§‘ ë§‰ë‚´ í¬ìŠ¤! ì£¼ë³€ ì‚¬ëŒë“¤ì´ ì•Œì•„ì„œ ì„±ê³µìœ¼ë¡œ ì´ëŒì–´ ì¤„ ìƒ.' },
  { name: 'ì—”ì ¤ íˆ¬ìì',      desc: 'ëˆê³¼ ì¸ë³µì´ ìŒìœ¼ë¡œ í„°ì§„ ìƒ! ë‹¹ì‹  ê³ì— ìˆìœ¼ë©´ ë‹¤ ê°™ì´ ë¶€ì ë  ê²ƒ ê°™ì€ ë“ ë“ í•¨!' },
  { name: 'ì„ í•œ ì˜í–¥ë ¥ ë¦¬ë”', desc: 'ë§ˆìŒê¹Œì§€ ë¶€ìœ í•œ ìì‚°ê°€! ì¡´ê²½ê³¼ ë¶€ë¥¼ ë™ì‹œì— ê±°ë¨¸ì¥˜ ì™„ë²½í•œ ìœ¡ê°í˜• ê´€ìƒ!' },
  { name: 'ì·¨ë¯¸ ë¶€ì ê°“ìƒëŸ¬', desc: 'ëˆì— ì«“ê¸°ì§€ ì•Šê³  ë¶€ë¥¼ ë‹¤ìŠ¤ë¦¬ëŠ” ê³ ìˆ˜! ì¸ìƒ ë§¤ì¼ë§¤ì¼ì´ ì¶•ì œì¼ ê±°ì˜ˆìš”.' },
  { name: 'ìˆ¨ì€ ìì‚°ê°€',      desc: 'ì¡°ìš©íˆ ì„¸ìƒì„ ì›€ì§ì´ëŠ” ìŠ¤í…”ìŠ¤ ëŸ­ì…”ë¦¬! ì…ì„ ì—¬ëŠ” ìˆœê°„ ì‹œì¥ì˜ íŒë„ê°€ ë°”ë€ë‹ˆë‹¤.' },
  { name: 'ë¸Œë ˆì¸ ë¦¬ë”',      desc: 'ì§€ì  ì„¹ì‹œí•¨ì˜ ì •ì ! ê·¸ ëª…ì„í•œ ë‘ë‡Œë¡œ ììˆ˜ì„±ê°€ì˜ ì—­ì‚¬ë¥¼ ìƒˆë¡œ ì“°ê² êµ°ìš”.' },
  { name: 'ë§ˆì´ë‹¤ìŠ¤ì˜ ì†',    desc: 'ë§Œì§€ëŠ” ê²ƒë§ˆë‹¤ í™©ê¸ˆìœ¼ë¡œ ë³€í•˜ëŠ” ì‚¬ê¸°ìº ê´€ìƒ! ë¹„ì¦ˆë‹ˆìŠ¤ ê°ê°ì´ ê±°ì˜ ì‹ ê³„ê¸‰ì´ë„¤ìš”.' },
  { name: 'ì „ëµì  ìŠ¹ë¶€ì‚¬',    desc: 'ì‹¤íŒ¨ë¥¼ ëª¨ë¥´ëŠ” í™•ì‹ ì˜ ìŠ¹ë¦¬ì ê´€ìƒ! ìì‚° ê·¸ë˜í”„ëŠ” ìš°ìƒí–¥ë§Œ ê³ ì§‘í•  ê±°ì˜ˆìš”.' },
  { name: 'ë¯¸ë˜ ì„ êµ¬ì',      desc: 'ì‹œëŒ€ë¥¼ ì•ì„œê°€ëŠ” í˜œì•ˆ! ë¯¸ë˜ì˜ ìì‚°ê°€ ë­í‚¹ ìƒë‹¨ì— ë‹¹ì‹ ì˜ ì´ë¦„ì´ ë³´ì—¬ìš”.' },
  { name: 'ë…ë³´ì  ì·¨í–¥ê°€',    desc: 'ë»”í•œ ê±´ ê±°ë¶€í•˜ëŠ” ì˜ˆìˆ ì  ëŸ­ì…”ë¦¬! ë…ì°½ì„±ì´ ë‹¹ì‹ ì„ ê±°ëŒ€í•œ ë¶€ìë¡œ ë§Œë“¤ í•µì‹¬ í‚¤!' },
  { name: 'ë””ì§€í„¸ ë…¸ë§ˆë“œ',    desc: 'ì§€êµ¬ ë°˜ëŒ€í¸ì—ì„œë„ ë‹¬ëŸ¬ ì°ì–´ë‚¼ í”„ë¡œ ì¼íƒˆëŸ¬! ë‹¹ì‹ ì˜ ì—¬ê¶Œì€ ì´ë¯¸ ìì‚° ì¦ëª…ì„œì…ë‹ˆë‹¤.' },
  { name: 'ì•„í‹€ë¦¬ì— ì˜¤ë„ˆ',    desc: 'ì°½ì¡°ì  ì—ë„ˆì§€ê°€ ê°“ë²½í•œ ì˜ˆìˆ ì  ë¶€í‹°! ì†ê¸¸ì´ ë‹¿ëŠ” ëª¨ë“  ê²ƒì´ ì½˜í…ì¸ ê°€ ë˜ê³  ëˆì´ ë¼ìš”.' },
  { name: 'ì†Œì‹  ëŸ­ì…”ë¦¬',      desc: 'ì¤‘ì‹¬ì´ í™•ê³ í•œ ë‚˜ë§Œì˜ ì œêµ­ ê±´ì„¤ì! ë‹¨ë‹¨í•œ ìì¡´ê°ì´ ì„±ê³µì˜ ì£¼ì¶§ëŒì´ ë  ê±°ì˜ˆìš”.' },
];

// ë§¤ì¹­ ë¡œì§: ìƒìœ„ ì¹´í…Œê³ ë¦¬ ì¡°í•©ìœ¼ë¡œ 20ê°œ ê²°ê³¼ ë§¤í•‘
function matchResult(sorted) {
  const [top1, top2] = sorted; // {className, probability}
  const t1 = top1.className;
  const t2 = top2.className;
  const p1 = top1.probability;

  // ì••ë„ì  1ìœ„ (70% ì´ìƒ)
  if (p1 >= 0.70) {
    if (t1 === 'ê·€í‹°')  return RESULTS[0];  // ë¡œì—´ ë¸”ëŸ¬ë“œ
    if (t1 === 'ìš°ì•„í•¨') return RESULTS[3]; // í´ë˜ì‹ ì•„ì´ì½˜
    if (t1 === 'ì§€ì ')  return RESULTS[12]; // ë¸Œë ˆì¸ ë¦¬ë”
    if (t1 === 'ì¹œê·¼í•¨') return RESULTS[9]; // ì„ í•œ ì˜í–¥ë ¥ ë¦¬ë”
    if (t1 === 'í™í•¨')  return RESULTS[4];  // íŠ¸ë Œë“œ ì„¸í„°
  }

  // 1ìœ„+2ìœ„ ì¡°í•© ë§¤í•‘
  const combo = t1 + '+' + t2;
  const comboMap = {
    'ê·€í‹°+ìš°ì•„í•¨':    RESULTS[1],  // ëŒ€ì €íƒì˜ ì£¼ì¸
    'ê·€í‹°+ì§€ì ':      RESULTS[7],  // í”„ë¼ì´ë¹— VIP
    'ê·€í‹°+í™í•¨':      RESULTS[2],  // ì•„íŠ¸ ë””ë ‰í„°
    'ê·€í‹°+ì¹œê·¼í•¨':    RESULTS[8],  // ì—”ì ¤ íˆ¬ìì
    'ìš°ì•„í•¨+ê·€í‹°':    RESULTS[1],  // ëŒ€ì €íƒì˜ ì£¼ì¸
    'ìš°ì•„í•¨+ì§€ì ':    RESULTS[11], // ìˆ¨ì€ ìì‚°ê°€
    'ìš°ì•„í•¨+ì¹œê·¼í•¨':  RESULTS[3],  // í´ë˜ì‹ ì•„ì´ì½˜
    'ìš°ì•„í•¨+í™í•¨':    RESULTS[16], // ë…ë³´ì  ì·¨í–¥ê°€
    'ì§€ì +ê·€í‹°':      RESULTS[5],  // ìœ ë‹ˆì½˜ ì°½ì—…ì£¼
    'ì§€ì +í™í•¨':      RESULTS[15], // ë¯¸ë˜ ì„ êµ¬ì
    'ì§€ì +ì¹œê·¼í•¨':    RESULTS[13], // ë§ˆì´ë‹¤ìŠ¤ì˜ ì†
    'ì§€ì +ìš°ì•„í•¨':    RESULTS[14], // ì „ëµì  ìŠ¹ë¶€ì‚¬
    'ì¹œê·¼í•¨+ê·€í‹°':    RESULTS[8],  // ì—”ì ¤ íˆ¬ìì
    'ì¹œê·¼í•¨+ì§€ì ':    RESULTS[10], // ì·¨ë¯¸ ë¶€ì ê°“ìƒëŸ¬
    'ì¹œê·¼í•¨+í™í•¨':    RESULTS[17], // ë””ì§€í„¸ ë…¸ë§ˆë“œ
    'ì¹œê·¼í•¨+ìš°ì•„í•¨':  RESULTS[9],  // ì„ í•œ ì˜í–¥ë ¥ ë¦¬ë”
    'í™í•¨+ê·€í‹°':      RESULTS[6],  // í™í•œ ì½œë ‰í„°
    'í™í•¨+ì§€ì ':      RESULTS[18], // ì•„í‹€ë¦¬ì— ì˜¤ë„ˆ
    'í™í•¨+ì¹œê·¼í•¨':    RESULTS[19], // ì†Œì‹  ëŸ­ì…”ë¦¬
    'í™í•¨+ìš°ì•„í•¨':    RESULTS[6],  // í™í•œ ì½œë ‰í„°
  };
  return comboMap[combo] || RESULTS[Math.floor(Math.random() * RESULTS.length)];
}

// =============================================
// ğŸ° Fun Data ëœë¤ ìƒì„±
// =============================================
const VALUE_LIST = [
  { v: 'ì•½ 120ì–µ ì›', hint: 'í•œë‚¨ íœíŠ¸í•˜ìš°ìŠ¤ + í¬ë¥´ì‰ 3ëŒ€' },
  { v: 'ì•½ 340ì–µ ì›', hint: 'ê°•ë‚¨ ë¹Œë”© ë°˜ ì¸µ + ì¹˜í‚¨ 1,000ë§Œ ë§ˆë¦¬' },
  { v: 'ì•½ 720ì–µ ì›', hint: 'ê°•ë‚¨ ë¹Œë”© í•œ ì±„ + ìŠ¤íƒ€ë²…ìŠ¤ ë§¤ì¥ 200ê°œ' },
  { v: 'ì•½ 550ì–µ ì›', hint: 'í•œê°•ë·° ì•„íŒŒíŠ¸ 50ì±„ + í•´ì™¸ì—¬í–‰ í‰ìƒ ë¬´ë£Œ' },
  { v: 'ì•½ 980ì–µ ì›', hint: 'ì½”ìŠ¤í”¼ ì‹œì´ ìƒìœ„ ì…ì„± + ê°œì¸ ì œíŠ¸ê¸° 3ëŒ€' },
  { v: 'ì•½ 450ì–µ ì›', hint: '3ì„±ê¸‰ í˜¸í…” í†µì§¸ë¡œ + ì—ë¥´ë©”ìŠ¤ ì „ ë¼ì¸ì—…' },
];

const RARITY_LIST = [
  'ìƒìœ„ 0.1% ë ˆì–´ë¦¬í‹° âœ¨',
  'ì „ì„¤ì˜ í™©ê¸ˆ ê´€ìƒ ğŸ‘‘',
  'ìƒìœ„ 0.05% ì‚¬ê¸°ìº ê´€ìƒ ğŸ”¥',
  'ì‹ í™” ë“±ê¸‰ ìì‚°ê°€ DNA ğŸ’',
  'ì „ì„¤ê¸‰ ë¶€í‹° ì†Œìœ ì ğŸŒŸ',
  'ì´ˆì›”ê¸‰ ì¬ë¬¼ìš´ ë³´ìœ ì âš¡',
];

const LUCKY_ITEMS = [
  'ì•„ì•„ ìƒ· ì¶”ê°€ â˜•', 'ì‹¤í¬ ë„¥íƒ€ì´ ğŸ‘”', 'ì–´ê¹¨ í´ê³  ê±·ê¸° ğŸš¶',
  'ê³¨ë“œ ì¹´ë“œ ì§€ê°‘ ğŸ’³', 'í–¥ìˆ˜ í•œ ìŠ¤í”„ë ˆì´ âœ¨', 'ì¢‹ì•„í•˜ëŠ” í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ğŸµ',
  'í”„ë¦¬ë¯¸ì—„ ë…¸íŠ¸ ğŸ“’', '11ì‹œ 11ë¶„ ì†Œì› ë¹Œê¸° ğŸ•¯ï¸', 'ìŠ¤ìŠ¤ë¡œì—ê²Œ ì¹­ì°¬ í•œ ë§ˆë”” ğŸ’Œ',
  'ì„ ê¸€ë¼ìŠ¤ í•˜ë‚˜ ë” ğŸ•¶ï¸', 'ì† ë³´ìŠµ í¬ë¦¼ ğŸ§´', 'ì¢‹ì€ ìì„¸ ìœ ì§€í•˜ê¸° ğŸ’ª',
];

const WEATHER_LIST = [
  'ğŸ’¥ í­ë°œ ì§ì „', 'â˜€ï¸ ë§‘ìŒ ë’¤ ì…ê¸ˆ', 'ğŸŒ¤ï¸ íë¦¼ ë’¤ íš¡ì¬',
  'âš¡ ë²ˆê°œê°™ì€ ê¸°íšŒ ë„ë˜', 'ğŸŒˆ ë¬´ì§€ê°œ ëœ¨ë©´ ëŒ€ë°•', 'ğŸ”® ë¶€ì ê¸°ìš´ í­ë°œ ì¤‘',
  'ğŸŒŠ ëˆë²¼ë½ íŒŒë„ ì ‘ê·¼',  'âœ¨ ë³„ë¹› ì¬ë¬¼ìš´ MAX',
];

function getRandom(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

function generateFunStats() {
  const val = getRandom(VALUE_LIST);
  return [
    { icon: 'ğŸ’°', label: 'ê´€ìƒ ê°€ì¹˜', value: val.v },
    { icon: 'ğŸ“Š', label: 'í¬ê·€ë„', value: getRandom(RARITY_LIST) },
    { icon: 'ğŸ€', label: 'ì˜¤ëŠ˜ì˜ í–‰ìš´í…œ', value: getRandom(LUCKY_ITEMS) },
    { icon: 'ğŸŒ¤ï¸', label: 'ì¬ë¬¼ìš´ ë‚ ì”¨', value: getRandom(WEATHER_LIST) },
  ];
}

// =============================================
// ğŸ›ï¸ íŒŒíŠ¸ë„ˆìŠ¤ ì•„ì´í…œ (íƒ€ì…ë³„)
// =============================================
const AD_ITEMS_DEFAULT = [
  { icon: 'ğŸ‘”', name: 'í•˜ì´ì—”ë“œ ì‹¤í¬ ì…”ì¸ ', price: 'â‚©89,000', url: 'https://link.coupang.com' },
  { icon: 'ğŸ’', name: 'ê³¨ë“œ ë¯¸ë‹ˆë©€ ì£¼ì–¼ë¦¬', price: 'â‚©54,000', url: 'https://link.coupang.com' },
  { icon: 'ğŸ•¶ï¸', name: 'í”„ë¦¬ë¯¸ì—„ ì„ ê¸€ë¼ìŠ¤', price: 'â‚©129,000', url: 'https://link.coupang.com' },
];

// =============================================
// ğŸ—ï¸ APP STATE & LOGIC
// =============================================
let model = null;
let imageFile = null;
let imageBlobUrl = null;

const loadingMessages = [
  'ê´€ìƒ ë°ì´í„°ë² ì´ìŠ¤ì™€ ëŒ€ì¡° ì¤‘ ğŸ”',
  'ë¶€í‹° ì§€ìˆ˜ ê³„ì‚° ì¤‘ ğŸ’',
  'ìˆ¨ê²¨ì§„ ìì‚°ê°€ DNA ì¶”ì¶œ ì¤‘ ğŸ§¬',
  'ì „ìƒ ì„±ì£¼ ê¸°ë¡ ì—´ëŒ ì¤‘ ğŸ“œ',
  'ì•„ìš°ë¼ ìŠ¤ìºë„ˆ ê°€ë™ ì¤‘ âœ¨',
];

// ëª¨ë¸ ë¡œë“œ
async function loadModel() {
  try {
    model = await tmImage.load(MODEL_URL + 'model.json', MODEL_URL + 'metadata.json');
    console.log('âœ… ëª¨ë¸ ë¡œë“œ ì™„ë£Œ! ì´ì œ ë¶€í‹°ë¥¼ ë¶„ì„í•  ì¤€ë¹„ê°€ ëì–´ìš” ğŸ‰');
  } catch(e) {
    console.error('ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨:', e);
    // ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨í•´ë„ ì•±ì€ ê³„ì† ë™ì‘ (ì—ëŸ¬ëŠ” ë¶„ì„ ì‹œì ì— í‘œì‹œ)
  }
}
loadModel();

// ì´ë¯¸ì§€ë¥¼ canvasë¡œ ë³€í™˜ (CORS ìš°íšŒ + Teachable Machine í˜¸í™˜)
function imageToCanvas(imgEl) {
  const canvas = document.createElement('canvas');
  const size = 224; // Teachable Machine ê¸°ë³¸ ì…ë ¥ í¬ê¸°
  canvas.width = size;
  canvas.height = size;
  const ctx = canvas.getContext('2d');
  ctx.drawImage(imgEl, 0, 0, size, size);
  return canvas;
}

// File â†’ Blob URLë¡œ ë³€í™˜ (tainted canvas ë°©ì§€)

function handleFile(file) {
  if (!file.type.startsWith('image/')) { showToast('âŒ ì´ë¯¸ì§€ íŒŒì¼ë§Œ ê°€ëŠ¥í•´ìš”!'); return; }
  imageFile = file;

  // ê¸°ì¡´ Blob URL í•´ì œ
  if (imageBlobUrl) URL.revokeObjectURL(imageBlobUrl);
  imageBlobUrl = URL.createObjectURL(file);

  previewImg.onload = () => {
    previewSection.style.display = 'block';
    document.getElementById('preview-bottom').style.display = 'block';
    uploadZone.style.display = 'none'; // ì—…ë¡œë“œ ì¡´ ìˆ¨ê¸°ê³  ì‚¬ì§„ìœ¼ë¡œ ëŒ€ì²´
    analyzeBtn.style.display = 'block';
    resultSection.style.display = 'none';
    setTimeout(() => analyzeBtn.scrollIntoView({ behavior:'smooth', block:'center' }), 200);
  };
  previewImg.src = imageBlobUrl;
}

// ë¡œë”© ë©”ì‹œì§€ ì‚¬ì´í´
function cycleLoadingMsg() {
  let i = 0;
  return setInterval(() => {
    document.getElementById('loadingMsg').textContent = loadingMessages[i % loadingMessages.length];
    i++;
  }, 1200);
}

// DOM refs
const uploadZone     = document.getElementById('uploadZone');
const fileInput      = document.getElementById('fileInput');
const previewSection = document.getElementById('preview-section');
const previewImg     = document.getElementById('preview-img');
const analyzeBtn     = document.getElementById('analyze-btn');
const loadingSection = document.getElementById('loading-section');
const resultOverlay  = document.getElementById('result-overlay');
const saveBtn        = document.getElementById('saveBtn');
const retryBtn       = document.getElementById('retryBtn');

// ì—…ë¡œë“œ ì¡´ í´ë¦­ â†’ íŒŒì¼ ì„ íƒ
uploadZone.addEventListener('click', () => fileInput.click());
// ì‚¬ì§„ ìœ„ ì˜¤ë²„ë ˆì´ í´ë¦­ â†’ íŒŒì¼ êµì²´
document.getElementById('uploadZoneOverlay').addEventListener('click', () => fileInput.click());

fileInput.addEventListener('change', e => { if(e.target.files[0]) handleFile(e.target.files[0]); });

uploadZone.addEventListener('dragover', e => { e.preventDefault(); uploadZone.classList.add('drag-over'); });
uploadZone.addEventListener('dragleave', () => uploadZone.classList.remove('drag-over'));
uploadZone.addEventListener('drop', e => {
  e.preventDefault();
  uploadZone.classList.remove('drag-over');
  if (e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);
});

// Analyze
analyzeBtn.addEventListener('click', async () => {
  if (!model) {
    showToast('â³ ëª¨ë¸ ë¡œë“œ ì¤‘! ì ì‹œ í›„ ë‹¤ì‹œ ëˆŒëŸ¬ì£¼ì„¸ìš”~');
    loadModel(); // ì¬ì‹œë„
    return;
  }

  analyzeBtn.disabled = true;
  analyzeBtn.textContent = 'âœ¨ ë¶„ì„ ì¤‘...';
  loadingSection.style.display = 'block';

  const msgInterval = cycleLoadingMsg();
  await new Promise(r => setTimeout(r, 1200));

  try {
    const canvas = imageToCanvas(previewImg);
    const predictions = await model.predict(canvas);

    // =============================================
    // ğŸŒ¡ï¸ Temperature Scaling + ìµœì†Œ ë³´ì¥ê°’
    // Tê°’ì´ í´ìˆ˜ë¡ ë¶„í¬ê°€ ê· ë“±í•´ì§ (1=ì›ë³¸, 3=ë¶€ë“œëŸ½ê²Œ, 5=ë§¤ìš° ê· ë“±)
    // =============================================
    const TEMPERATURE = 3.5;
    const MIN_SHARE = 0.05; // ê° í•­ëª© ìµœì†Œ 5% ë³´ì¥

    // 1ë‹¨ê³„: logit ì¶”ì • (softmax ì—­ì‚°)
    const probs = predictions.map(p => Math.max(p.probability, 1e-7));
    const logits = probs.map(p => Math.log(p));

    // 2ë‹¨ê³„: Temperatureë¡œ ë‚˜ëˆ ì„œ ì¬ê³„ì‚°
    const scaledLogits = logits.map(l => l / TEMPERATURE);
    const maxLogit = Math.max(...scaledLogits);
    const expScaled = scaledLogits.map(l => Math.exp(l - maxLogit)); // ìˆ˜ì¹˜ ì•ˆì •ì„±
    const expSum = expScaled.reduce((a, b) => a + b, 0);
    let scaledProbs = expScaled.map(e => e / expSum);

    // 3ë‹¨ê³„: ìµœì†Œê°’ ë³´ì¥ (MIN_SHARE ì´í•˜ë©´ ëŒì–´ì˜¬ë¦¬ê³  ë‚˜ë¨¸ì§€ì—ì„œ ì°¨ê°)
    const n = scaledProbs.length;
    let adjusted = [...scaledProbs];
    let deficit = 0;
    adjusted = adjusted.map(p => {
      if (p < MIN_SHARE) { deficit += MIN_SHARE - p; return MIN_SHARE; }
      return p;
    });
    // ìµœì†Œê°’ë³´ë‹¤ í° í•­ëª©ë“¤ì—ì„œ deficit ë¹„ë¡€ ì°¨ê°
    const totalAbove = adjusted.reduce((s, p) => s + (p > MIN_SHARE ? p : 0), 0);
    adjusted = adjusted.map(p => p > MIN_SHARE ? p - (p / totalAbove) * deficit : p);

    // 4ë‹¨ê³„: í•©ì´ 1ì´ ë˜ë„ë¡ ì¬ì •ê·œí™”
    const finalSum = adjusted.reduce((a, b) => a + b, 0);
    adjusted = adjusted.map(p => p / finalSum);

    // 5ë‹¨ê³„: ì›ë³¸ predictionsì— ìƒˆ í™•ë¥  ì ìš©
    const smoothed = predictions.map((p, i) => ({
      className: p.className,
      probability: adjusted[i],
    }));

    const sorted = [...smoothed].sort((a,b) => b.probability - a.probability);
    const matched = matchResult(sorted);
    const funStats = generateFunStats();

    clearInterval(msgInterval);
    loadingSection.style.display = 'none';
    renderResult(sorted, matched, funStats);

  } catch(err) {
    clearInterval(msgInterval);
    loadingSection.style.display = 'none';
    console.error(err);
    showToast('ğŸ˜… ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”!');
    analyzeBtn.disabled = false;
    analyzeBtn.textContent = 'ğŸ’ ë‚´ ë¶€í‹° ë¶„ì„í•˜ê¸°';
  }
});

function renderResult(sorted, matched, stats) {
  // Name & desc
  document.getElementById('result-name').textContent = matched.name;
  document.getElementById('result-desc').textContent = matched.desc;

  // Stats
  const statsGrid = document.getElementById('stats-grid');
  statsGrid.innerHTML = '';
  stats.forEach(s => {
    statsGrid.innerHTML += `
      <div class="stat-item">
        <div class="stat-icon">${s.icon}</div>
        <div class="stat-label">${s.label}</div>
        <div class="stat-value">${s.value}</div>
      </div>`;
  });

  // Bars
  const barsContainer = document.getElementById('bars-container');
  barsContainer.innerHTML = '';
  sorted.forEach((p, i) => {
    const pct = (p.probability * 100).toFixed(1);
    barsContainer.innerHTML += `
      <div class="bar-row">
        <span class="bar-label">${p.className}</span>
        <div class="bar-track">
          <div class="bar-fill bar-fill-${i}" data-pct="${pct}"></div>
        </div>
        <span class="bar-pct bar-pct-${i}">${pct}%</span>
      </div>`;
  });

  // Ad items
  const adItems = document.getElementById('ad-items');
  adItems.innerHTML = '';
  AD_ITEMS_DEFAULT.forEach(item => {
    adItems.innerHTML += `
      <a href="${item.url}" target="_blank" rel="noopener" class="ad-item">
        <div class="ad-item-icon">${item.icon}</div>
        <div class="ad-item-name">${item.name}</div>
        <div class="ad-item-price">${item.price}</div>
      </a>`;
  });

  // Show overlay
  resultOverlay.style.display = 'block';
  document.body.style.overflow = 'hidden'; // ë’· ë°°ê²½ ìŠ¤í¬ë¡¤ ë§‰ê¸°
  analyzeBtn.disabled = false;
  analyzeBtn.textContent = 'ğŸ’ ë‚´ ë¶€í‹° ë¶„ì„í•˜ê¸°';

  // Animate bars
  setTimeout(() => {
    document.querySelectorAll('.bar-fill').forEach(bar => {
      bar.style.width = bar.dataset.pct + '%';
    });
  }, 200);

  // ì˜¤ë²„ë ˆì´ ìƒë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤
  document.querySelector('.overlay-body').scrollTop = 0;
}

// ë’¤ë¡œê°€ê¸°
document.getElementById('backBtn').addEventListener('click', closeOverlay);

function closeOverlay() {
  resultOverlay.style.display = 'none';
  document.body.style.overflow = '';
}

// Save as Image (Instagram 9:16)
saveBtn.addEventListener('click', async () => {
  showToast('ğŸ“¸ ì´ë¯¸ì§€ ì €ì¥ ì¤‘...');
  const card = document.getElementById('result-card');
  try {
    const canvas = await html2canvas(card, {
      backgroundColor: null,
      scale: 2,
      useCORS: true,
      logging: false,
    });

    // 9:16 canvas
    const W = canvas.width;
    const H = Math.round(W * (16/9));
    const finalCanvas = document.createElement('canvas');
    finalCanvas.width = W;
    finalCanvas.height = H;
    const ctx = finalCanvas.getContext('2d');

    // Gradient BG
    const grad = ctx.createLinearGradient(0, 0, W, H);
    grad.addColorStop(0, '#ffd6e7');
    grad.addColorStop(0.4, '#e8d5ff');
    grad.addColorStop(0.8, '#c8e6ff');
    grad.addColorStop(1, '#d4f1d4');
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, W, H);

    // Center card
    const yOffset = Math.round((H - canvas.height) / 2);
    ctx.drawImage(canvas, 0, yOffset);

    // Watermark
    ctx.fillStyle = 'rgba(90,74,122,0.5)';
    ctx.font = `${Math.round(W * 0.035)}px Gowun Dodum`;
    ctx.textAlign = 'center';
    ctx.fillText('ğŸ’ ë¶€í‹° í…ŒìŠ¤íŠ¸ Â· noble-test.shop', W/2, H - Math.round(W * 0.04));

    const link = document.createElement('a');
    link.download = `ë¶€í‹°í…ŒìŠ¤íŠ¸_${document.getElementById('result-name').textContent}.png`;
    link.href = finalCanvas.toDataURL('image/png');
    link.click();
    showToast('âœ… ì €ì¥ ì™„ë£Œ! ì¸ìŠ¤íƒ€ì— ì˜¬ë ¤ë³´ì„¸ìš” ğŸŒŸ');
  } catch(e) {
    console.error(e);
    showToast('ğŸ˜… ì €ì¥ ì‹¤íŒ¨. ìŠ¤í¬ë¦°ìƒ·ì„ ì´ìš©í•´ì£¼ì„¸ìš”!');
  }
});

// Retry
retryBtn.addEventListener('click', () => {
  closeOverlay();
  previewSection.style.display = 'none';
  document.getElementById('preview-bottom').style.display = 'none';
  uploadZone.style.display = 'block';
  analyzeBtn.style.display = 'none';
  fileInput.value = '';
  previewImg.src = '';
  imageBlobUrl = null;
  showToast('ğŸ”„ ìƒˆë¡œìš´ ë¶€í‹°ë¥¼ ì°¾ì•„ë³¼ê¹Œìš”? ğŸ’œ');
});

// Toast
function showToast(msg) {
  const toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 2800);
}
</script>


</body></html>
